<!DOCTYPE html><html><head>
      <title>readme</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\SApro\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.13\crossnote\dependencies\katex\katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="usi-thymio---elvi-mihai-sabau-sabau--yassine-oueslati">USI THYMIO - Elvi Mihai Sabau Sabau &amp; Yassine Oueslati </h1>
<p>Assignament 2 for the Robotis Assignment at USI MSc in AI.</p>
<hr>
<h2 id="task-1">Task 1: </h2>
<p>Write an open-loop controller that moves the MyT in such a way that it follows an "8" trajectory. Test it in the default empty scene.</p>
<h3 id="solution">Solution: </h3>
<p>For this task, we developed a controller which controls the thymio using 2 states, <code>circle_right</code> and <code>circle_left</code>. A timer of 5.5 seconds changes the trajectory, this is the exact time needed to complete a circle. The controller is implemented in a way that the robot will follow the 8 trajectory indefinitely.</p>
<h3 id="launch-command">Launch command: </h3>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>ros2 launch usi_thymio eight.launch.xml thymio_name:<span class="token operator">=</span>thymio_0
---------------------------------------
parameters:
  thymio_name: by default is thymio0, depending on <span class="token function">which</span> version of the bridge youre running, you might need to change it to thymio_0.
</code></pre><h3 id="video">Video: </h3>
<p><a href="https://youtu.be/WXkSSgUwkO4?si=gl776xxTJmN6oOQN&amp;t=5">https://youtu.be/WXkSSgUwkO4?si=gl776xxTJmN6oOQN&amp;t=5</a></p>
<hr>
<h2 id="tasks-2-and-3">Tasks 2 and 3: </h2>
<p>Using the wall scene file, write a controller to move the MyT straight ahead. Note that this scene rotates randomly the wall every time it is reset. We assume the robot is heading toward a wall somewhere in front of it; the wall is not necessarily orthogonal to the direction the MyT is originally pointing to. Write the controller in such a way that the MyT moves straight ahead until it is close to the wall (without hitting it), then turns in place in such a way to face the wall as precisely as possible (i.e., the robot's x-axis should be orthogonal to the wall). To sense the wall orientation once you are close to it, you should use proximity sensors. Feel free to define a convenient distance threshold at which you decide to stop. (3pt)</p>
<p>Using the controller built for task 2, once the MyT arrives close to the wall, it should then turn in such a way that it is facing opposite to the wall, then move and stop in such a way that the robot is as close as possible to a point that is 2 meters away from the wall. Note that the proximity sensors don't have such a long range, so at some point, you'll have to rely on odometry. (4pt)</p>
<h3 id="solution-1">Solution: </h3>
<p>For this task we developed again a controller that uses 4 states: <code>FORWARD</code>, <code>FACE_WALL</code>, <code>TURN_AROUND</code> and <code>FORWARD_2M</code>.</p>
<p>A control loop handles the state transition, initially being <code>FORWARD</code>.</p>
<p>Logic of each state:</p>
<ul>
<li>
<p><code>FORWARD</code>: The robot moves forward until the proximity sensors detect an obstacle. To get a proper reading, the moment the sensors pick something up, the thymio will slow down and approach the wall until the sensor with the lowest value ( the closest sensor to the wall ) meets a certain distance threshold, close enough to the wall to get good readings from the sensors, but not enough to touch the wall. After this, the thymio stops and the state will change to <code>FACE_WALL</code>.</p>
</li>
<li>
<p><code>FACE_WALL</code>: The thymio will rotate towards the direction where the sensors have the highest value, this way we know we'll be rotating to align with the wall ( facing the wall ), and it will stop rotating the moment both central-lateral have the same value given a error threshold. After this, we stop moving the thymio the state will change to <code>TURN_AROUND</code>.</p>
</li>
<li>
<p><code>TURN_AROUND</code>: This one was the trickiest part, we rotate the thymio and also move slowly backwards ( we do this because if we rotate the thymio in place, the back sensors will still be too far away to detect the wall, and since odometry is screwed up beyond recognition we can't rely on anything else but sensors ) until any of the back sensors detect the wall. Then we stop rotating and we'll slowly move backwards and rotate towards the direction of the sensor with the highest value, this way we'll be aligning our back with the wall, and once both back sensors have the same value given an error threshold, we stop and change the state to <code>FORWARD_2M</code>.</p>
</li>
<li>
<p><code>FORWARD_2M</code>: We move slowly forward, and using the odometry ( coordinates )<br>
we calculate the euclidean distance traveled, and once we reach 2 meters, we stop the thymio and the controller.</p>
</li>
</ul>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>ros2 launch usi_thymio compulsory.launch.xml thymio_name:<span class="token operator">=</span>thymio_0
---------------------------------------
parameters:
  thymio_name: by default is thymio0, depending on <span class="token function">which</span> version of the bridge youre running, you might need to change it to thymio_0.
</code></pre><h3 id="video-1">Video: </h3>
<p><a href="https://youtu.be/WXkSSgUwkO4?si=78hWAR4YBFo4-Iug&amp;t=13">https://youtu.be/WXkSSgUwkO4?si=78hWAR4YBFo4-Iug&amp;t=13</a></p>
<hr>
<h2 id="advanced-1-and-2">Advanced 1 and 2: </h2>
<p>Write a controller that randomly explores an environment, avoiding any obstacles (similar to what a Roomba would do).<br>
Deploy the robot in the scene that we made (link) for Coppelia.<br>
Submit a link to a video demonstrating the robot's behavior (accelerate the video 10x to show in 10 seconds how the robot behaves over 100 simulated seconds)</p>
<p>Explore the environment as before, but simulate two or more robots at once. Adapt the controller so that the two Thymios avoid each other when they get close. Make sure your video shows what happens.<br>
In case you complete this task, make advanced.launch.xml launch it one instead of advanced task 1</p>
<h3 id="solution-2">Solution: </h3>
<p>For this tasks we made a simple controller that moves forward, and when the proximity sensors detect an obstacle, the thymio will rotate toward the direction with the highest sensor value, and then move forward again. This way the thymio will avoid obstacles.</p>
<p>The controller also implements a squeeze-trough feature, the tymio will try and squeeze through tight spaces if no lateral sensor reaches certain closeness threshold and the central sensors detect no obstacles, this way the thymio will be able to explore the environment more efficiently.</p>
<p>Also in case of <em>uncertain conditions</em>*, the thymio will rotate towards a random direction, this will also avoid the thymio getting stuck in a <em>movement loop</em>**.</p>
<p>Also, given this previous logic, we dont need to implement anything else to make the thymio avoid each other, since the thymio will stop and rotate when it detects an obstacle.</p>
<p>*: uncertain conditions are when the thymio doesn't know if it should turn right or left, this happens for example when the thymio is in a corner and the sensors detect obstacles at the same dfistances on both sides.</p>
<p>**: movement loop is when the thymio is repeating the same movement pattern due to the environment layout.</p>
<h3 id="launch-command-1">Launch command: </h3>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>ros2 launch usi_thymio advanced.launch.xml thymio_0:<span class="token operator">=</span>thymio_0 thymio_1:<span class="token operator">=</span>thymio_1
---------------------------------------
parameters:
  thymio_0: name of the first thymio
  thymio_1: name of the second thymio
</code></pre><h3 id="video--exploration-">Video ( Exploration ): </h3>
<p><a href="https://youtu.be/WXkSSgUwkO4?si=56n3iOkhu9C0v4nH&amp;t=48">https://youtu.be/WXkSSgUwkO4?si=56n3iOkhu9C0v4nH&amp;t=48</a></p>
<h3 id="video--avoidance-">Video ( Avoidance ): </h3>
<p><a href="https://youtu.be/WXkSSgUwkO4?si=FXbRLg13lhLpxZSU&amp;t=98">https://youtu.be/WXkSSgUwkO4?si=FXbRLg13lhLpxZSU&amp;t=98</a></p>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>